Step-0: Setup the required DB_Link between the downstream and APEX instance

Step-1: Create Master Table
	/* Data is populated from downstream oracle instance (INSTC), which retrieves data from the upstream systems */
	CREATE TABLE XX_OIM_MASTER_AUDIT AS
	SELECT * FROM APPS.XX_WORKDAY_MASTER_AUDIT@APEX_INSTC;
	 
Step-2: Create table which takes the user data dump from FND_USER tables from (INSTA, INSTB, INSTC, INSTD, INSTF)
	 
	CREATE TABLE XX_INSTA_USER AS
	SELECT 
	    (SELECT UPPER(INSTANCE_NAME) FROM V$INSTANCE@APEX_INSTA) AS INSTANCE_NAME
	    ,FU.*
	    ,(SELECT SYSDATE FROM DUAL) EXTRACT_DATE
	FROM 
	    FND_USER@APEX_INSTA FU;
	 
	CREATE TABLE XX_INSTB_USER AS
	SELECT 
	    (SELECT UPPER(INSTANCE_NAME) FROM V$INSTANCE@APEX_INSTB) AS INSTANCE_NAME
	    ,FU.*
	    ,(SELECT SYSDATE FROM DUAL) EXTRACT_DATE
	FROM 
	    FND_USER@APEX_INSTB FU;
	    
	CREATE TABLE XX_INSTC_USER AS
	SELECT 
	    (SELECT UPPER(INSTANCE_NAME) FROM V$INSTANCE@APEX_INSTC) AS INSTANCE_NAME
	    ,FU.*
	    ,(SELECT SYSDATE FROM DUAL) EXTRACT_DATE
	FROM 
	    FND_USER@APEX_INSTC FUAG;
	    
	CREATE TABLE XX_INSTD_USER AS
	SELECT 
	    (SELECT UPPER(INSTANCE_NAME) FROM V$INSTANCE@APEX_INSTD) AS INSTANCE_NAME
	    ,FU.*
	    ,(SELECT SYSDATE FROM DUAL) EXTRACT_DATE
	FROM 
	    FND_USER@APEX_INSTD FU;
	    
	CREATE TABLE XX_INSTE_USER AS
	SELECT 
	    (SELECT UPPER(INSTANCE_NAME) FROM V$INSTANCE@APEX_INSTE) AS INSTANCE_NAME
	    ,FU.*
	    ,(SELECT SYSDATE FROM DUAL) EXTRACT_DATE
	FROM 
	    FND_USER@APEX_INSTE FU;
 
Step-3: Create table which takes the Responsibility data dump from fnd_responsibility_vl tables from (INSTA, INSTB, INSTC, INSTD, INSTF)
 
	CREATE TABLE XX_INSTA_RESP_AVAIL AS
	SELECT (SELECT UPPER(INSTANCE_NAME) 
	FROM V$INSTANCE@APEX_INSTA) AS INSTANCE_NAME,
	FRV.*, (SELECT SYSDATE FROM DUAL) EXTRACT_DATE
	FROM FND_RESPONSIBILITY_VL@APEX_INSTA FRV;
 
	CREATE TABLE XX_INSTB_RESP_AVAIL AS
	SELECT (SELECT UPPER(INSTANCE_NAME) 
	FROM V$INSTANCE@APEX_INSTB) AS INSTANCE_NAME, FRV.*, 
	(SELECT SYSDATE FROM DUAL) EXTRACT_DATE
	FROM FND_RESPONSIBILITY_VL@APEX_INSTB FRV;
	 
	CREATE TABLE XX_INSTC_RESP_AVAIL AS
	SELECT (SELECT UPPER(INSTANCE_NAME) 
	FROM V$INSTANCE@APEX_INSTC) AS INSTANCE_NAME, FRV.*, (SELECT SYSDATE FROM DUAL) EXTRACT_DATE
	FROM FND_RESPONSIBILITY_VL@APEX_INSTC FRV;
	 
	CREATE TABLE XX_INSTD_RESP_AVAIL AS
	SELECT (SELECT UPPER(INSTANCE_NAME) 
	FROM V$INSTANCE@APEX_INSTD) AS INSTANCE_NAME, FRV.*, (SELECT SYSDATE FROM DUAL) EXTRACT_DATE
	FROM FND_RESPONSIBILITY_VL@APEX_INSTD FRV;
	 
	CREATE TABLE XX_INSTF_RESP_AVAIL AS
	SELECT (SELECT UPPER(INSTANCE_NAME) 
	FROM V$INSTANCE@APEX_INSTF) AS INSTANCE_NAME, FRV.*, (SELECT SYSDATE FROM DUAL) EXTRACT_DATE
	FROM FND_RESPONSIBILITY_VL@APEX_INSTF FRV;
 
Step-4: Create table which takes the responsibilities which are held by the users from fnd_user_resp_groups_direct from (INSTA, INSTB, INSTC, INSTD, INSTF)
 
	CREATE TABLE XX_INSTA_RESP_USER AS ( SELECT 
	    (SELECT UPPER(INSTANCE_NAME) FROM V$INSTANCE@APEX_INSTA) AS INSTANCE_NAME
	    ,FURGD.*
	    ,(SELECT SYSDATE FROM DUAL) EXTRACT_DATE
	    FROM FND_USER_RESP_GROUPS_DIRECT@APEX_INSTA FURGD
	);
	 
	CREATE TABLE XX_INSTB_RESP_USER AS (
	    SELECT 
	        (SELECT UPPER(INSTANCE_NAME) FROM V$INSTANCE@APEX_INSTB) AS INSTANCE_NAME
	        ,FURGD.*
	        ,SYSDATE AS EXTRACT_DATE
	    FROM FND_USER_RESP_GROUPS_DIRECT@APEX_INSTB FURGD
	);
	 
	CREATE TABLE XX_INSTC_RESP_USER AS (
	    SELECT 
	        (SELECT UPPER(INSTANCE_NAME) FROM V$INSTANCE@APEX_INSTC) AS INSTANCE_NAME
	        ,FURGD.*
	        ,SYSDATE AS EXTRACT_DATE
	    FROM FND_USER_RESP_GROUPS_DIRECT@APEX_INSTC FURGD
	);
	 
	CREATE TABLE XX_INSTD_RESP_USER AS (
	    SELECT 
	        (SELECT UPPER(INSTANCE_NAME) FROM V$INSTANCE@APEX_INSTD) AS INSTANCE_NAME
	        ,FURGD.*
	        ,SYSDATE AS EXTRACT_DATE
	    FROM FND_USER_RESP_GROUPS_DIRECT@APEX_INSTD FURGD
	);
	 
	CREATE TABLE XX_INSTE_RESP_USER AS (
	    SELECT 
	        (SELECT UPPER(INSTANCE_NAME) FROM V$INSTANCE@APEX_INSTE) AS INSTANCE_NAME
	        ,FURGD.*
	        ,SYSDATE AS EXTRACT_DATE
	    FROM FND_USER_RESP_GROUPS_DIRECT@APEX_INSTE FURGD
	);
	 
